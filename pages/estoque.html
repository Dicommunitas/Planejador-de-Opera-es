<!DOCTYPE html> 
<html lang="pt-BR"> 
<head> 
    <meta charset="UTF-8"> 
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <title>Importação e Visualização de Estoque</title> 
    <link rel="stylesheet" href="../css/styles.css"> 
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script> 
    <script type="module" src="../js/components/Header.js"></script> 
    <script type="module" src="../js/components/DropZone.js"></script> 
    <script type="module" src="../js/components/Footer.js"></script> 
</head> 
<body> 
    <app-header></app-header> 
 
    <div id="app"> 
        <div id="importInstructions"> 
            <h2>Como obter o arquivo do sistema BDEMQ:</h2> 
            <ol> 
                <li>Acesse o sistema BDEMQ através do link interno da Petrobras.</li> 
                <li>Navegue até a seção "2.6.3.10 - Boletim Diário de Estoque".</li> 
                <li>Selecione o relatório de estoque de tanques.</li> 
                <li>Escolha o formato de arquivo Excel (.xls ou .xlsx).</li> 
                <li>Clique no botão de download para salvar o arquivo em seu computador.</li> 
            </ol> 
        </div> 
 
        <drop-zone></drop-zone> 
 
        <div id="stockVisualization"> 
            <h2>Visualização de Estoque</h2> 
            <table id="stockTable"> 
                <thead> 
                    <tr> 
                        <th>Selecionar</th> 
                        <th>Produto</th> 
                        <th>Tanque</th> 
                        <th>Disponível para Envio (m³)</th> 
                        <th>Espaço para Recebimento (m³)</th> 
                    </tr> 
                </thead> 
                <tbody></tbody> 
            </table> 
        </div> 
 
        <button id="transferButton">Transferir Dados Selecionados para o Planejador</button> 
    </div> 
 
    <app-footer></app-footer> 
 
    <script type="module">
        import { setupImportacao } from '../js/estoque/importacao.js';
        import { setupTransferencia, updateSelectionState } from '../js/estoque/transferencia.js';
        import { initVisualizacao } from '../js/estoque/visualizacao.js';
      


        document.addEventListener('DOMContentLoaded', () => {
          setupImportacao();
          setupTransferencia();
          initVisualizacao();
          updateSelectionState();
      
          const dropZone = document.querySelector('dropZone');
          if (dropZone) {
            dropZone.addEventListener('fileProcessed', (event) => {
              if (event.detail.success) {
                initVisualizacao();
                updateSelectionState();
              } else {
                alert('Erro ao processar o arquivo: ' + event.detail.error);
              }
            });
          } else {
            console.error('Elemento <drop-zone> não encontrado no DOM.');
          }
        });
      </script>
</body> 
</html> 
